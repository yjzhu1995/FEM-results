	program insert
c********************************************************************
c This program adds extra depth points in fname(1) to fname(2), so
c that the two files have the same depth points (first column)
c
c for example,
c fname(2) can be generated by program cooling.f.
c if fname(1) is generated by program brittle.f for the same depths,
c it has two extra depths at Byerlee's law's break point.
c********************************************************************
	dimension x2(10000),y2(10000)
	character fname(2)*15
	call getarg(1,fname(1))
	open(1,file=fname(1))
	call getarg(2,fname(2))
	open(2,file=fname(2))
	kfile=0
	i1=1
	i2=2
	call insert1(i1,i2,x2,y2,fname,kfile)
	if(kfile.eq.0) stop
	i1=2
	i2=1
	call insert1(i1,i2,x2,y2,fname,kfile)
	stop
	end
c
c
	subroutine insert1(i1,i2,x2,y2,fname,kfile)
	dimension x2(*),y2(*)
	character fname(2)*15
	rewind i1
	rewind i2
	k=0
10	k=k+1
	read(i2,*,end=50) x2(k),y2(k)
	goto 10
50	n=k-1
	rewind i2
	k=0
	kk=0
100	k=k+1
	read(i1,*,end=200) x1
	if(x1.eq.x2(k)) then
	  write(i2,*) x2(k),y2(k)
	else if(x1.gt.x2(k)) then
c	  print*, 'stop insert: x1 > x2 at k = ',k
	  write(i2,*) x2(k),y2(k)
	  backspace(i1)
	  kfile=1
	else
	  yy=y2(k-1)+(y2(k)-y2(k-1))/(x2(k)-x2(k-1))*(x1-x2(k-1))
	  write(i2,*) x1,yy
	  k=k-1
	  kk=kk+1
	end if
	goto 100
200	print*, kk,' points inserted into file ',fname(i2)
	return
	end
